<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Common Datasets &mdash; MLX Data 0.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mlx.data.datasets.load_mnist" href="_autosummary/mlx.data.datasets.load_mnist.html" />
    <link rel="prev" title="mlx.data.Stream.prefetch" href="_autosummary/mlx.data.Stream.prefetch.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MLX Data
          </a>
              <div class="version">
                0.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Build and Install</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../buffers_streams_samples.html">Buffers, Streams and Samples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Common operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="buffer.html">Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="stream.html">Stream</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Common Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_mnist.html">mlx.data.datasets.load_mnist</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_cifar10.html">mlx.data.datasets.load_cifar10</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_cifar100.html">mlx.data.datasets.load_cifar100</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_imagenet.html">mlx.data.datasets.load_imagenet</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_librispeech.html">mlx.data.datasets.load_librispeech</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlx.data.datasets.load_wikitext_lines.html">mlx.data.datasets.load_wikitext_lines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tokenizing.html">Tokenizing with MLX data</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Feature extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="miscellaneous.html">Miscellaneous</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MLX Data</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Common Datasets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python/common_datasets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="common-datasets">
<h1>Common Datasets<a class="headerlink" href="#common-datasets" title="Permalink to this headline"></a></h1>
<p>Although MLX data is designed to make it easy to implement your own data
pipeline directly in your own scripts, we provide some utility functions that
make it easy to access some commonly used datasets.</p>
<p>For instance the following is an example interaction that loads the MNIST and
the wikitext-103 datasets.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlx.data</span> <span class="k">as</span> <span class="nn">dx</span>
<span class="kn">from</span> <span class="nn">mlx.data.datasets</span> <span class="kn">import</span> <span class="n">load_mnist</span><span class="p">,</span> <span class="n">load_wikitext_lines</span>
<span class="kn">from</span> <span class="nn">mlx.data.tokenizer_helpers</span> <span class="kn">import</span> <span class="n">read_trie_from_vocab</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">load_mnist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mnist</span><span class="p">)</span>
<span class="c1"># Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz 9.5MiB (15.1MiB/s)</span>
<span class="c1"># Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz 1.6MiB (12.9MiB/s)</span>
<span class="c1"># Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz 32.0KiB (17.1MiB/s)</span>
<span class="c1"># Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz 8.0KiB (26.6MiB/s)</span>
<span class="c1"># Buffer(size=60000, keys={&#39;label&#39;, &#39;image&#39;})</span>

<span class="n">mnist_iter</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">mnist</span>
    <span class="o">.</span><span class="n">shuffle</span><span class="p">()</span>
    <span class="o">.</span><span class="n">to_stream</span><span class="p">()</span>
    <span class="o">.</span><span class="n">key_transform</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
    <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
    <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">mnist_iter</span><span class="p">)[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># (128, 784)</span>

<span class="n">wiki</span> <span class="o">=</span> <span class="n">load_wikitext_lines</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wiki</span><span class="p">)</span>
<span class="c1"># Downloading https://s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-raw-v1.zip 183.1MiB (9.9MiB/s)</span>
<span class="c1"># Computing hash of ..../.cache/mlx.data/wikitext/wikitext-103-raw-v1.zip |████████████████████████████████████████| 183.1MiB / 183.1MiB (1.0GiB/s)</span>
<span class="c1"># Extracting ..../.cache/mlx.data/wikitext/wikitext-103-raw-v1.zip 517.9MiB (318.2MiB/s)</span>
<span class="c1"># Stream()</span>

<span class="n">workers</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">trie</span> <span class="o">=</span> <span class="n">read_trie_from_vocab</span><span class="p">(</span><span class="s2">&quot;/path/to/vocab.txt&quot;</span><span class="p">)</span>
<span class="n">wiki_iterator</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">wiki</span>
    <span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">trie</span><span class="p">,</span> <span class="n">output_key</span><span class="o">=</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter_key</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">workers</span><span class="p">)</span>
    <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tokens</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># gather everything in a big array of tokens</span>
    <span class="o">.</span><span class="n">sliding_window</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">,</span> <span class="mi">1025</span><span class="p">,</span> <span class="mi">1025</span><span class="p">)</span>
    <span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="s2">&quot;tokens&quot;</span><span class="p">,</span> <span class="s2">&quot;tokens_length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># actual batch size</span>
    <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># The above can be iterated at approximately 2.5M tok/s on an M2 Macbook Air.</span>
</pre></div>
</div>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_mnist.html#mlx.data.datasets.load_mnist" title="mlx.data.datasets.load_mnist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_mnist</span></code></a>([root, train])</p></td>
<td><p>Load a buffer with the MNIST dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_cifar10.html#mlx.data.datasets.load_cifar10" title="mlx.data.datasets.load_cifar10"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_cifar10</span></code></a>([root, train, quiet, ...])</p></td>
<td><p>Load a buffer with the CIFAR-10 dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_cifar100.html#mlx.data.datasets.load_cifar100" title="mlx.data.datasets.load_cifar100"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_cifar100</span></code></a>([root, train, quiet, ...])</p></td>
<td><p>Load a buffer with the CIFAR-100 dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_imagenet.html#mlx.data.datasets.load_imagenet" title="mlx.data.datasets.load_imagenet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_imagenet</span></code></a>([root, split, quiet, ...])</p></td>
<td><p>Load the ImageNet dataset from the downloaded archives.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_librispeech.html#mlx.data.datasets.load_librispeech" title="mlx.data.datasets.load_librispeech"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_librispeech</span></code></a>([root, split, quiet, ...])</p></td>
<td><p>Load the librispeech dataset directly from the TAR archive.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_autosummary/mlx.data.datasets.load_wikitext_lines.html#mlx.data.datasets.load_wikitext_lines" title="mlx.data.datasets.load_wikitext_lines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_wikitext_lines</span></code></a>([root, split, subset, ...])</p></td>
<td><p>Fetch the WikiText dataset and load it as a stream of lines.</p></td>
</tr>
</tbody>
</table>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_autosummary/mlx.data.Stream.prefetch.html" class="btn btn-neutral float-left" title="mlx.data.Stream.prefetch" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="_autosummary/mlx.data.datasets.load_mnist.html" class="btn btn-neutral float-right" title="mlx.data.datasets.load_mnist" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, MLX Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>